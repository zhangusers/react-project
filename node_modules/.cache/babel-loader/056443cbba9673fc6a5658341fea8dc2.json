{"ast":null,"code":"import _initializerDefineProperty from \"/Users/zhangzhuang/React/react-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _applyDecoratedDescriptor from \"/Users/zhangzhuang/React/react-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"/Users/zhangzhuang/React/react-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper\";\n\nvar _class, _descriptor, _descriptor2, _descriptor3, _descriptor4;\n\nimport { observable, action } from \"mobx\";\nlet LayoutStore = (_class = class LayoutStore {\n  constructor() {\n    _initializerDefineProperty(this, \"openKeys\", _descriptor, this);\n\n    _initializerDefineProperty(this, \"selectedKeys\", _descriptor2, this);\n\n    _initializerDefineProperty(this, \"onOpenChange\", _descriptor3, this);\n\n    _initializerDefineProperty(this, \"activeNavs\", _descriptor4, this);\n  }\n\n  // 页面跳转, 重新改变 openKeys, selectedKeys,\n  init(menuConfig, url) {\n    let condition = url === \"/\";\n    const openUrl = condition ? 'home/list' : url;\n    this.openKeys = [`/${openUrl.split(\"/\")[1]}`];\n\n    if (condition) {\n      this.selectedKeys = ['home/list'];\n    } else {\n      this.activeNavs(menuConfig, url).map(item => {\n        if (item.length > 0) {\n          this.selectedKeys = [item[0].path];\n        }\n\n        return false;\n      });\n    }\n  } // 修改title\n\n\n  changeDocTitle(menuConfig, url) {\n    return menuConfig.map(item => {\n      if (item.children) {\n        return item.children.map(item1 => {\n          const path = item1.path.split(':')[0];\n\n          if (url.indexOf(path) !== -1) {\n            document.title = item1.title;\n            return true;\n          }\n\n          return false;\n        });\n      } else {\n        if (url.indexOf(item.path) !== -1) {\n          document.title = item.title;\n          return true;\n        }\n\n        return false;\n      }\n    });\n  }\n\n}, (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"openKeys\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function () {\n    return [];\n  }\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"selectedKeys\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function () {\n    return [];\n  }\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"onOpenChange\", [action], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function () {\n    return openKeys => {\n      this.openKeys = openKeys;\n    };\n  }\n}), _descriptor4 = _applyDecoratedDescriptor(_class.prototype, \"activeNavs\", [action], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function () {\n    return (data, url) => {\n      return data.map(item => {\n        if (item.children) {\n          return item.children.filter(item1 => !item1.hidden && url.indexOf(item1.key || item1.path) !== -1);\n        }\n\n        return false;\n      });\n    };\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"init\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"init\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"changeDocTitle\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"changeDocTitle\"), _class.prototype)), _class);\nconst layoutStore = new LayoutStore();\nexport default layoutStore;","map":{"version":3,"sources":["/Users/zhangzhuang/React/react-admin/src/layouts/store.js"],"names":["observable","action","LayoutStore","init","menuConfig","url","condition","openUrl","openKeys","split","selectedKeys","activeNavs","map","item","length","path","changeDocTitle","children","item1","indexOf","document","title","data","filter","hidden","key","layoutStore"],"mappings":";;;;;;AAAA,SAAQA,UAAR,EAAoBC,MAApB,QAAiC,MAAjC;IAEMC,W,aAAN,MAAMA,WAAN,CAAkB;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAmBjB;AACQC,EAAAA,IAAI,CAACC,UAAD,EAAaC,GAAb,EAAkB;AAC7B,QAAIC,SAAS,GAAGD,GAAG,KAAK,GAAxB;AACM,UAAME,OAAO,GAAGD,SAAS,GAAG,WAAH,GAAiBD,GAA1C;AACA,SAAKG,QAAL,GAAgB,CAAE,IAAGD,OAAO,CAACE,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAsB,EAA3B,CAAhB;;AACN,QAAIH,SAAJ,EAAe;AACd,WAAKI,YAAL,GAAoB,CAAC,WAAD,CAApB;AACA,KAFD,MAEO;AACN,WAAKC,UAAL,CAAgBP,UAAhB,EAA4BC,GAA5B,EAAiCO,GAAjC,CAAsCC,IAAD,IAAU;AAC9C,YAAIA,IAAI,CAACC,MAAL,GAAc,CAAlB,EAAqB;AACpB,eAAKJ,YAAL,GAAoB,CAACG,IAAI,CAAC,CAAD,CAAJ,CAAQE,IAAT,CAApB;AACA;;AACD,eAAO,KAAP;AACA,OALD;AAMA;AACE,GAlCa,CAoCd;;;AACKC,EAAAA,cAAc,CAACZ,UAAD,EAAaC,GAAb,EAAkB;AACvC,WAAOD,UAAU,CAACQ,GAAX,CAAgBC,IAAD,IAAU;AAC/B,UAAIA,IAAI,CAACI,QAAT,EAAmB;AAClB,eAAOJ,IAAI,CAACI,QAAL,CAAcL,GAAd,CAAmBM,KAAD,IAAW;AACpB,gBAAMH,IAAI,GAAGG,KAAK,CAACH,IAAN,CAAWN,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAb;;AACf,cAAIJ,GAAG,CAACc,OAAJ,CAAYJ,IAAZ,MAAsB,CAAC,CAA3B,EAA8B;AAC7BK,YAAAA,QAAQ,CAACC,KAAT,GAAiBH,KAAK,CAACG,KAAvB;AACA,mBAAO,IAAP;AACA;;AACD,iBAAO,KAAP;AACA,SAPM,CAAP;AAQA,OATD,MASO;AACN,YAAIhB,GAAG,CAACc,OAAJ,CAAYN,IAAI,CAACE,IAAjB,MAA2B,CAAC,CAAhC,EAAmC;AAClCK,UAAAA,QAAQ,CAACC,KAAT,GAAiBR,IAAI,CAACQ,KAAtB;AACA,iBAAO,IAAP;AACA;;AACD,eAAO,KAAP;AACA;AACD,KAjBM,CAAP;AAkBA;;AAxDgB,C,0EAChBrB,U;;;;;WAAsB,E;;gFACtBA,U;;;;;WAA0B,E;;gFAG1BC,M;;;;;WAAuBO,QAAD,IAAc;AACpC,WAAKA,QAAL,GAAgBA,QAAhB;AACA,K;;8EAGAP,M;;;;;WAAoB,CAACqB,IAAD,EAAOjB,GAAP,KAAe;AACnC,aAAOiB,IAAI,CAACV,GAAL,CAAUC,IAAD,IAAU;AACzB,YAAIA,IAAI,CAACI,QAAT,EAAmB;AAClB,iBAAOJ,IAAI,CAACI,QAAL,CAAcM,MAAd,CAAsBL,KAAD,IAAW,CAACA,KAAK,CAACM,MAAP,IAAiBnB,GAAG,CAACc,OAAJ,CAAYD,KAAK,CAACO,GAAN,IAAaP,KAAK,CAACH,IAA/B,MAAyC,CAAC,CAA3F,CAAP;AACA;;AACD,eAAO,KAAP;AACA,OALM,CAAP;AAMA,K;;yDAGAd,M,gJAiBAA,M;AAsBF,MAAMyB,WAAW,GAAG,IAAIxB,WAAJ,EAApB;AACA,eAAewB,WAAf","sourcesContent":["import {observable, action} from \"mobx\";\n\nclass LayoutStore {\n\t@observable openKeys = [];\n\t@observable selectedKeys = [];\n\n\t// 点击改变 openKeys\n\t@action onOpenChange = (openKeys) => {\n\t\tthis.openKeys = openKeys;\n\t};\n\n\t// 菜单激活\n\t@action activeNavs = (data, url) => {\n\t\treturn data.map((item) => {\n\t\t\tif (item.children) {\n\t\t\t\treturn item.children.filter((item1) => !item1.hidden && url.indexOf(item1.key || item1.path) !== -1);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t};\n\n\t// 页面跳转, 重新改变 openKeys, selectedKeys,\n\t@action init(menuConfig, url) {\n\t\tlet condition = url === \"/\";\n        const openUrl = condition ? 'home/list' : url;\n        this.openKeys = [`/${openUrl.split(\"/\")[1]}`];\n\t\tif (condition) {\n\t\t\tthis.selectedKeys = ['home/list'];\n\t\t} else {\n\t\t\tthis.activeNavs(menuConfig, url).map((item) => {\n\t\t\t\tif (item.length > 0) {\n\t\t\t\t\tthis.selectedKeys = [item[0].path];\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n    }\n\n    // 修改title\n\t@action changeDocTitle(menuConfig, url) {\n\t\treturn menuConfig.map((item) => {\n\t\t\tif (item.children) {\n\t\t\t\treturn item.children.map((item1) => {\n                    const path = item1.path.split(':')[0];\n\t\t\t\t\tif (url.indexOf(path) !== -1) {\n\t\t\t\t\t\tdocument.title = item1.title;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (url.indexOf(item.path) !== -1) {\n\t\t\t\t\tdocument.title = item.title;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n}\n\nconst layoutStore = new LayoutStore();\nexport default layoutStore;\n"]},"metadata":{},"sourceType":"module"}